{"version":3,"file":"main.3af79b519a1ee79a3c8a.js","mappings":"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","sources":["webpack://omraggas/./src/js/lang.js","webpack://omraggas/./src/js/audio-info.js","webpack://omraggas/./src/js/play.js","webpack://omraggas/./src/js/viewport-height.js","webpack://omraggas/./src/js/about.js","webpack://omraggas/./src/js/controls.js","webpack://omraggas/./src/js/debounce.js"],"sourcesContent":["'use strict';\n\nvar html = document.querySelector('html');\n\nexport function getElementsInLang(selector) {\n    var lang = html.getAttribute('lang');\n    var elements = document.querySelectorAll(selector + '.lang--' + lang);\n\n    if (elements.length > 1) {\n        return elements;\n    } else {\n        return elements[0];\n    }\n}\n\nexport function changeLang() {\n    var currentLang = html.getAttribute('lang');\n    var lang;\n\n    if (currentLang === 'ru') {\n        lang = 'en';\n    } else {\n        lang = 'ru';\n    }\n\n    html.setAttribute('lang', lang);\n};","'use strict';\n\nimport {getElementsInLang} from './lang.js';\n\nvar TIMECODE_LENGTH = 11;\nvar text = document.querySelector('.audio-info__text');\nvar infoBuffer;\nvar infoMoch;\nvar audioInfo;\nvar centerX = window.innerWidth / 2;\nvar centerY = window.innerHeight / 2;\n\n(function wrapText() {\n    document.addEventListener('DOMContentLoaded', () => {\n        wrap(text);\n        infoMoch = text.innerHTML;\n    });\n})();\n\nclass AudioInfo {\n    constructor(name) {\n        this.name = name.substring(0, name.lastIndexOf('.')),\n            this.currentTime = '00:00',\n            this.duration = '00:00'\n    }\n\n    update(timeCode, duration) {\n        var currentTime = formatSecondsAsTime(timeCode);\n        var duration = formatSecondsAsTime(duration);\n\n        if (currentTime !== this.currentTime) {\n            this.currentTime = currentTime;\n            this.duration = duration;\n            return true;\n        }\n\n        return false;\n    }\n\n    printInfo() {\n        return this.name + ' ' + this.printTime();\n    }\n\n    printTime() {\n        return this.currentTime + '/' + this.duration;\n    }\n}\n\nexport function updateAudioInfo(timeCode, duration) {\n    if (audioInfo.update(timeCode, duration)) {\n        updateTextContent();\n    }\n};\n\nexport function wrapAudioInfo(name) {\n    audioInfo = new AudioInfo(name);\n    text.innerHTML = audioInfo.printInfo();\n    wrap(text);\n    infoBuffer = text.innerHTML;\n};\n\nexport function toggleInfoActive(state) {\n    text.innerHTML = '';\n    switch (state) {\n        case 'PLAY':\n            text.innerHTML = infoBuffer;\n            break;\n        case 'PAUSE':\n            text.innerHTML = infoMoch;\n            break;\n        default:\n            break;\n    }\n};\n\nexport function toggleTransparentText() {\n    text.classList.toggle('audio-info__text--transparent');\n};\n\nexport function toggleTextPlayed() {\n    text.classList.toggle('audio-info__text--played');\n}\n\nfunction updateTextContent() {\n    var time = audioInfo.printTime();\n    var chars = text.querySelectorAll('span');\n    var cnt = TIMECODE_LENGTH - 1;\n    for (let i = chars.length - 1; i > (chars.length - TIMECODE_LENGTH); i--) {\n        chars[i].textContent = time[cnt];\n        cnt--;\n    }\n};\n\nfunction wrap(txt) {\n    if (!txt) return;\n\n    var start = -90;\n    var angle = 360;\n\n    var characters = txt.innerHTML.split('');\n    var step = angle / characters.length - 1;\n    var radius = getRadius();\n\n    txt.innerHTML = '';\n\n    characters.forEach((item, index) => {\n        buildItem(index);\n    });\n\n    function getRadius() {\n        var root = document.querySelector(':root');\n        var rootStyles = getComputedStyle(root);\n        return parseFloat(rootStyles.getPropertyValue('--btn-size'), 10) - 20;\n    };\n\n    function buildItem(i) {\n        var item = document.createElement('span');\n        item.innerHTML = characters[i];\n        txt.appendChild(item);\n        var w = item.clientWidth;\n        var h = item.clientHeight;\n        var a = (start + step * i) * Math.PI / 180;\n        item.style.left = centerX - w / 2 + radius * Math.sin(a) + 'px';\n        item.style.top = centerY - h - radius * Math.cos(a) + 'px';\n        item.style.transform = 'rotate(' + a + 'rad)';\n    };\n};\n\n\nfunction formatSecondsAsTime(secs) {\n    var hr = Math.floor(secs / 3600);\n    var min = Math.floor((secs - (hr * 3600)) / 60);\n    var sec = Math.floor(secs - (hr * 3600) - (min * 60));\n\n    if (min < 10) {\n        min = '0' + min;\n    }\n    if (sec < 10) {\n        sec = '0' + sec;\n    }\n\n    return min + ':' + sec;\n}","'use strict';\nimport {\n    updateAudioInfo,\n    wrapAudioInfo,\n    toggleInfoActive,\n    toggleTextPlayed\n} from './audio-info.js';\n\nimport {\n    debounce\n} from './debounce.js';\n\nvar audio = document.getElementById('audio');\nvar btnPlay = document.querySelector('.player-btn');\nvar audioList = {};\nvar CLICK_INTERVAL = 500;\n\nclass CurrentRaggas {\n    constructor() {\n        this.time = undefined,\n            this.playList = [],\n            this.currentTrackIndex = 0,\n            this.currentTrack = undefined,\n            this.isTouched = false\n    }\n\n    getNextTrack() {\n        var currentTrack = this.currentTrackIndex;\n        if (currentTrack === this.playList.length - 1) {\n            this.currentTrackIndex = 0;\n        } else {\n            this.currentTrackIndex++;\n        }\n\n        this.currentTrack = this.playList[currentTrack];\n\n        return this.playList[currentTrack];\n    }\n\n    touched() {\n        this.isTouched = true;\n    }\n\n    untouched() {\n        this.isTouched = false;\n    }\n}\nvar currentRaggas = new CurrentRaggas();\nvar AUDIO_SRC = './src/audio/';\n\nfunction fetchAudioList() {\n    fetch('/src/audio/audio.json')\n        .then(response => response.json())\n        .then(json => {\n            audioList = json;\n            currentRaggas.playList = getPlayList(new Date());\n        });\n}\n\nfunction getAudioTrack() {\n    var track = currentRaggas.getNextTrack();\n    console.log('Get New Track: ', track)\n    return AUDIO_SRC + currentRaggas.time + '/' + track;\n}\n\nfunction setExpirationTime(timeEnd) {\n    var currentDate = new Date();\n    var endDate = new Date(new Date().setHours(timeEnd, 0, 0, 0));\n    var expirationTime = endDate.getTime() - currentDate.getTime();\n    console.log('Expiration Time(ms): ', expirationTime);\n    var timeOut = setTimeout(() => {\n        clearTimeout(timeOut);\n        currentRaggas = new CurrentRaggas();\n        currentRaggas.playList = getPlayList(new Date());\n    }, expirationTime);\n};\n\nfunction getPlayList(date) {\n    var hour = date.getHours();\n    for (var key in audioList) {\n        var [start, end] = key.split('-');\n        if (hour >= start && hour < end) {\n            currentRaggas.time = key;\n            console.log('Current playlist: ', currentRaggas.time)\n            setExpirationTime(end);\n            return audioList[key].sort(() => Math.random() - 0.5);\n        }\n    }\n};\n\nfunction playRaggas() {\n    if (!currentRaggas.isTouched) {\n        audio.src = getAudioTrack();\n        wrapAudioInfo(currentRaggas.currentTrack);\n    } else {\n        toggleInfoActive('PLAY');\n    };\n    audio.play();\n    currentRaggas.touched();\n}\n\nvar onBtnClick = (evt) => {\n    evt.preventDefault();\n\n    btnPlay.classList.toggle('player-btn--played');\n\n    if (btnPlay.classList.contains('player-btn--played')) {\n        playRaggas();\n    } else {\n        audio.pause();\n        toggleInfoActive('PAUSE');\n    }\n\n    toggleTextPlayed();\n};\n\nvar onAudioEnded = () => {\n    currentRaggas.untouched();\n    playRaggas();\n};\n\nexport function play() {\n    btnPlay.addEventListener('click', debounce(onBtnClick, CLICK_INTERVAL));\n    audio.addEventListener('ended', onAudioEnded);\n    audio.addEventListener('timeupdate', () => {\n        updateAudioInfo(audio.currentTime, audio.duration);\n    });\n    fetchAudioList();\n};\n\nexport function toggleVolume() {\n    if (audio.volume) {\n        audio.volume = 0;\n    } else {\n        audio.volume = 1;\n    }\n};","'use strict';\n\nconst controlVh = () => {\n  var vh = window.innerHeight * 0.01;\n  document.documentElement.style.setProperty('--vh', `${vh}px`);\n\n  window.addEventListener('resize', () => {\n    var vh = window.innerHeight * 0.01;\n    document.documentElement.style.setProperty('--vh', `${vh}px`);\n  });\n};\n\nexport {\n  controlVh\n};\n","'use strict';\n\nimport {\n    toggleTransparentText\n} from './audio-info.js';\n\nimport {\n    getElementsInLang\n} from './lang.js';\n\n\nexport function aboutAddObserver() {\n    var options = {\n        rootMargin: '-50%',\n        threshold: 0\n    }\n    var callback = function (entries, observer) {\n        entries.forEach(entry => {\n            if (!entry.isIntersecting) {\n                toggleTransparentText();\n            }\n        });\n    };\n\n    var observer = new IntersectionObserver(callback, options);\n    var target = getTarget();\n\n    observer.observe(target);\n};\n\nfunction getTarget() {\n    var texts = getElementsInLang('.about__text');\n    return texts[texts.length - 1];\n}","'use strict';\n\nimport {\n    changeLang\n} from './lang.js';\n\nimport {\n    toggleVolume\n} from './play.js';\n\nvar lang = document.querySelector('.controls__lang-btn');\nvar volume = document.querySelector('.controls__volume-btn');\n\nexport function initControls() {\n    volume.addEventListener('click', () => {\n        volume.classList.toggle('controls__volume-btn--mute');\n        toggleVolume();\n    });\n\n    lang.addEventListener('click', () => {\n        lang.classList.toggle('controls__lang-btn--en');\n        changeLang();\n    });\n};","export function debounce(f, ms) {\n\n    let isCooldown = false;\n    let lastTimeOut = null;\n\n    return function () {\n        if (isCooldown) return;\n\n        if (lastTimeOut) {\n            window.clearTimeout(lastTimeOut);\n        }\n\n        f.apply(this, arguments);\n\n        isCooldown = true;\n\n        lastTimeOut = setTimeout(() => isCooldown = false, ms);\n    };\n\n};"],"names":["infoBuffer","infoMoch","audioInfo","html","document","querySelector","TIMECODE_LENGTH","text","centerX","window","innerWidth","centerY","innerHeight","addEventListener","wrap","innerHTML","AudioInfo","constructor","name","this","substring","lastIndexOf","currentTime","duration","update","timeCode","formatSecondsAsTime","printInfo","printTime","toggleInfoActive","state","txt","root","rootStyles","characters","split","step","length","radius","getComputedStyle","parseFloat","getPropertyValue","forEach","item","index","i","createElement","appendChild","w","clientWidth","h","clientHeight","a","Math","PI","style","left","sin","top","cos","transform","buildItem","secs","hr","floor","min","sec","audio","getElementById","btnPlay","audioList","CurrentRaggas","time","undefined","playList","currentTrackIndex","currentTrack","isTouched","getNextTrack","touched","untouched","currentRaggas","AUDIO_SRC","setExpirationTime","timeEnd","currentDate","Date","expirationTime","setHours","getTime","console","log","timeOut","setTimeout","clearTimeout","getPlayList","date","hour","getHours","key","start","end","sort","random","playRaggas","track","src","play","vh","texts","observer","target","lang","volume","documentElement","setProperty","f","ms","isCooldown","lastTimeOut","apply","arguments","debounce","evt","preventDefault","classList","toggle","contains","pause","onAudioEnded","chars","querySelectorAll","cnt","textContent","updateTextContent","fetch","then","response","json","IntersectionObserver","entries","entry","isIntersecting","rootMargin","threshold","selector","getAttribute","elements","getElementsInLang","observe","setAttribute","changeLang"],"sourceRoot":""}