(()=>{"use strict";var t,e,n,r=document.querySelector("html"),i=11,o=document.querySelector(".audio-info__text"),a=window.innerWidth/2,s=window.innerHeight/2;document.addEventListener("DOMContentLoaded",(()=>{l(o),e=o.innerHTML}));class c{constructor(t){this.name=t.substring(0,t.lastIndexOf(".")),this.currentTime="00:00",this.duration="00:00"}update(t,e){var n=d(t);return e=d(e),n!==this.currentTime&&(this.currentTime=n,this.duration=e,!0)}printInfo(){return this.name+" "+this.printTime()}printTime(){return this.currentTime+"/"+this.duration}}function u(n){switch(o.innerHTML="",n){case"PLAY":o.innerHTML=t;break;case"PAUSE":o.innerHTML=e}}function l(t){if(t){var e,n,r=t.innerHTML.split(""),i=360/r.length-1,o=(e=document.querySelector(":root"),n=getComputedStyle(e),parseFloat(n.getPropertyValue("--btn-size"),10)-20);t.innerHTML="",r.forEach(((e,n)=>{!function(e){var n=document.createElement("span");n.innerHTML=r[e],t.appendChild(n);var c=n.clientWidth,u=n.clientHeight,l=(i*e-90)*Math.PI/180;n.style.left=a-c/2+o*Math.sin(l)+"px",n.style.top=s-u-o*Math.cos(l)+"px",n.style.transform="rotate("+l+"rad)"}(n)}))}}function d(t){var e=Math.floor(t/3600),n=Math.floor((t-3600*e)/60),r=Math.floor(t-3600*e-60*n);return n<10&&(n="0"+n),r<10&&(r="0"+r),n+":"+r}var h=document.getElementById("audio"),m=document.querySelector(".player-btn"),p={};class g{constructor(){this.time=void 0,this.playList=[],this.currentTrackIndex=0,this.currentTrack=void 0,this.isTouched=!1}getNextTrack(){var t=this.currentTrackIndex;return t===this.playList.length-1?this.currentTrackIndex=0:this.currentTrackIndex++,this.currentTrack=this.playList[t],this.playList[t]}touched(){this.isTouched=!0}untouched(){this.isTouched=!1}}var v=new g,T="./src/audio/";function y(t){var e=new Date,n=new Date((new Date).setHours(t,0,0,0)).getTime()-e.getTime();console.log("Expiration Time(ms): ",n);var r=setTimeout((()=>{clearTimeout(r),(v=new g).playList=f(new Date)}),n)}function f(t){var e=t.getHours();for(var n in p){var[r,i]=n.split("-");if(e>=r&&e<i)return v.time=n,console.log("Current playlist: ",v.time),y(i),p[n].sort((()=>Math.random()-.5))}}function L(){var e,r;v.isTouched?u("PLAY"):(h.src=(r=v.getNextTrack(),console.log("Get New Track: ",r),T+v.time+"/"+r),e=v.currentTrack,n=new c(e),o.innerHTML=n.printInfo(),l(o),t=o.innerHTML),h.play(),v.touched()}var w,M,x,b,E=document.querySelector(".controls__lang-btn"),_=document.querySelector(".controls__volume-btn");w=.01*window.innerHeight,document.documentElement.style.setProperty("--vh",`${w}px`),window.addEventListener("resize",(()=>{var t=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",`${t}px`)})),m.addEventListener("click",function(t,e){let n=!1,r=null;return function(){n||(r&&window.clearTimeout(r),t.apply(this,arguments),n=!0,r=setTimeout((()=>n=!1),e))}}((t=>{t.preventDefault(),m.classList.toggle("player-btn--played"),m.classList.contains("player-btn--played")?L():(h.pause(),u("PAUSE")),o.classList.toggle("audio-info__text--played")}),500)),h.addEventListener("ended",(()=>{v.untouched(),L()})),h.addEventListener("timeupdate",(()=>{var t,e;t=h.currentTime,e=h.duration,n.update(t,e)&&function(){var t=n.printTime(),e=o.querySelectorAll("span"),r=i-1;for(let n=e.length-1;n>e.length-i;n--)e[n].textContent=t[r],r--}()})),fetch("/src/audio/audio.json").then((t=>t.json())).then((t=>{p=t,v.playList=f(new Date)})),x=new IntersectionObserver((function(t,e){t.forEach((t=>{t.isIntersecting||o.classList.toggle("audio-info__text--transparent")}))}),{rootMargin:"-50%",threshold:0}),M=function(t){var e=r.getAttribute("lang"),n=document.querySelectorAll(".about__text.lang--"+e);return n.length>1?n:n[0]}(),b=M[M.length-1],x.observe(b),_.addEventListener("click",(()=>{_.classList.toggle("controls__volume-btn--mute"),h.volume?h.volume=0:h.volume=1})),E.addEventListener("click",(()=>{E.classList.toggle("controls__lang-btn--en"),function(){var t;t="ru"===r.getAttribute("lang")?"en":"ru",r.setAttribute("lang",t)}()}))})();
//# sourceMappingURL=main.3af79b519a1ee79a3c8a.js.map